# language: zh-TW
功能: 融資融券庫存抵銷
  作為交易者
  我想要正確追蹤融資融券交易的庫存變化
  特別是有昨日庫存時的抵銷規則

  場景: 資買+資賣 - 優先抵銷昨日庫存
    假設 我有昨日資買庫存 2330 數量 20 張
    當 我資買 2330 數量 10 張
    那麼 資買庫存應為 30 張，昨日庫存為 20 張，昨日已抵銷 0 張
    當 我資賣 2330 數量 15 張
    那麼 資買庫存應為 15 張，昨日庫存為 20 張，昨日已抵銷 15 張
    # 資賣優先抵銷昨日庫存 15 張
    # 當天買的 10 張不受影響
    # yd_quantity=20(固定), quantity=15, yd_offset_quantity=15
    # 昨日實際剩餘 = 20-15 = 5 張
    # 今日實際剩餘 = 15-(20-15) = 10 張

  場景: 資買+資賣 - 部分抵銷昨日庫存
    假設 我有昨日資買庫存 2330 數量 10 張
    當 我資買 2330 數量 5 張
    那麼 資買庫存應為 15 張，昨日庫存為 10 張，昨日已抵銷 0 張
    當 我資賣 2330 數量 7 張
    那麼 資買庫存應為 8 張，昨日庫存為 10 張，昨日已抵銷 7 張
    # 資賣只能抵銷昨日庫存，最多 10 張
    # yd_quantity=10(固定), quantity=8, yd_offset_quantity=7
    # 昨日實際剩餘 = 10-7 = 3 張
    # 今日實際剩餘 = 8-3 = 5 張

  場景: 券賣+券買 - 優先抵銷昨日庫存
    假設 我有昨日券賣庫存 2330 數量 20 張
    當 我券賣 2330 數量 10 張
    那麼 券賣庫存應為 30 張，昨日庫存為 20 張，昨日已抵銷 0 張
    當 我券買 2330 數量 15 張
    那麼 券賣庫存應為 15 張，昨日庫存為 20 張，昨日已抵銷 15 張
    # 券買優先抵銷昨日庫存

  場景: 只有昨日資買庫存 - 當天資賣
    假設 我有昨日資買庫存 2330 數量 10 張
    當 我資賣 2330 數量 5 張
    那麼 資買庫存應為 5 張，昨日庫存為 10 張，昨日已抵銷 5 張

  場景: 只有昨日券賣庫存 - 當天券買
    假設 我有昨日券賣庫存 2330 數量 10 張
    當 我券買 2330 數量 5 張
    那麼 券賣庫存應為 5 張，昨日庫存為 10 張，昨日已抵銷 5 張
